import networkx as nx
import pandas as pd

# Побудова графа
G = nx.DiGraph()

# Додаємо ребра та їх пропускні здатності
edges = [
    ("Термінал 1", "Склад 1", 25), ("Термінал 1", "Склад 2", 20), ("Термінал 1", "Склад 3", 15),
    ("Термінал 2", "Склад 3", 15), ("Термінал 2", "Склад 4", 30), ("Термінал 2", "Склад 2", 10),
    ("Склад 1", "Магазин 1", 15), ("Склад 1", "Магазин 2", 10), ("Склад 1", "Магазин 3", 20),
    ("Склад 2", "Магазин 4", 15), ("Склад 2", "Магазин 5", 10), ("Склад 2", "Магазин 6", 25),
    ("Склад 3", "Магазин 7", 20), ("Склад 3", "Магазин 8", 15), ("Склад 3", "Магазин 9", 10),
    ("Склад 4", "Магазин 10", 20), ("Склад 4", "Магазин 11", 10), ("Склад 4", "Магазин 12", 15),
    ("Склад 4", "Магазин 13", 5), ("Склад 4", "Магазин 14", 10)
]

G.add_weighted_edges_from(edges, weight='capacity')

# Знаходження максимального потоку
source = "Термінал 1"
target = "Склад 1"
max_flow_1, flow_dict_1 = nx.maximum_flow(G, source, target)

source_2 = "Термінал 2"
target_2 = "Склад 4"
max_flow_2, flow_dict_2 = nx.maximum_flow(G, source_2, target_2)

# Формування таблиці результатів
results = []
for term, flow in zip(["Термінал 1", "Термінал 2"], [max_flow_1, max_flow_2]):
    for shop in ["Магазин 1", "Магазин 2", "Магазин 3", "Магазин 4", "Магазин 5",
                 "Магазин 6", "Магазин 7", "Магазин 8", "Магазин 9", "Магазин 10",
                 "Магазин 11", "Магазин 12", "Магазин 13", "Магазин 14"]:
        results.append((term, shop, flow))

df_results = pd.DataFrame(results, columns=["Термінал", "Магазин", "Фактичний Потік (одиниць)"])

# Відображення результатів
print(df_results)
# Аналіз отриманих результатів
# 1️⃣ Які термінали забезпечують найбільший потік товарів до магазинів?
# Термінал 1 постачає 25 одиниць товарів у кожен магазин.
# Термінал 2 постачає 30 одиниць у кожен магазин.
# Термінал 2 забезпечує більший потік товарів, ніж Термінал 1.
# 2️⃣ Які маршрути мають найменшу пропускну здатність, і як це впливає на загальний потік?
# Згідно з початковими даними, деякі шляхи мають значно меншу пропускну здатність:
# Наприклад, ребро Термінал 1 → Склад 3 має лише 15 одиниць.
# Це могло створити "вузьке місце" в розподілі потоку.
# Якщо сума потоків перевищує ці значення, виникають обмеження.
# 3️⃣ Які магазини отримали найменше товарів і чи можна збільшити їх постачання?
# Всі магазини отримали по 25 або 30 одиниць товарів.
# Проте, якщо модель використовувала неправильний алгоритм підрахунку потоків, треба перевірити, чи є обмеження на рівні складів.
# Для збільшення поставок потрібно перевірити, чи можна збільшити пропускну здатність між складами та магазинами.
# 4️⃣ Чи є вузькі місця, які можна усунути для покращення ефективності логістичної мережі?
# Ймовірні вузькі місця:
# Обмежені пропускні спроможності складів (якщо загальна пропускна здатність складу менша за потреби магазинів).
# Якщо деякі склади перевантажені, але інші мають невикористані потужності, можливо, потрібно перерозподілити потік.
# Варто провести аналіз, чи всі канали передачі вантажу використовуються максимально ефективно.
